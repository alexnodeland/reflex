# {{ project_name }}

{{ description }}

Built with [Reflex](https://github.com/alexnodeland/reflex) - an event-driven AI agent framework.

{% if github_username %}
[![CI](https://github.com/{{ github_username }}/{{ project_name | lower | replace(' ', '-') }}/actions/workflows/ci.yml/badge.svg)](https://github.com/{{ github_username }}/{{ project_name | lower | replace(' ', '-') }}/actions/workflows/ci.yml)
{% endif %}
[![Python {{ python_version }}+](https://img.shields.io/badge/python-{{ python_version }}+-blue.svg)](https://www.python.org/downloads/)

## Quick Start

```bash
# Configure environment
cp .env.example .env
# Edit .env with your API keys (ANTHROPIC_API_KEY, etc.)

# Start everything (includes PostgreSQL)
docker compose up
```

**Endpoints:**

| Service | URL |
|---------|-----|
| API | http://localhost:8000 |
| WebSocket | ws://localhost:8000/ws |
| Health | http://localhost:8000/health |
| Docs | http://localhost:8000/docs |

## Sending Events

```bash
# Via HTTP
curl -X POST http://localhost:8000/events \
  -H "Content-Type: application/json" \
  -d '{"type": "http", "payload": {"message": "Hello!"}}'

# Or connect via WebSocket
websocat ws://localhost:8000/ws
```

## Project Structure

```
src/{{ project_slug }}/
├── infra/     # Infrastructure (EventStore, database) - keep stable
├── core/      # Core types (events, deps) - extend with your events
├── agent/     # Agent logic (triggers, filters) - your main code goes here
└── api/       # FastAPI routes and WebSocket handlers
```

## Development

```bash
make dev          # Start with hot reload
make test         # Run tests in Docker
make lint         # Check code quality
make type-check   # Run pyright
make ci           # Full CI pipeline locally
```

## Creating Your Agent

### 1. Define Events

```python
# src/{{ project_slug }}/core/events.py
from {{ project_slug }}.core.events import EventRegistry, BaseEvent

@EventRegistry.register
class MyEvent(BaseEvent):
    type: Literal["my.event"] = "my.event"
    data: str
```

### 2. Create Filters

```python
# src/{{ project_slug }}/agent/filters.py
from {{ project_slug }}.agent.filters import type_filter

my_event_filter = type_filter("my.event")
```

### 3. Build Your Agent

```python
# src/{{ project_slug }}/agent/agents.py
from pydantic_ai import Agent

my_agent = Agent(
    "anthropic:claude-sonnet-4-20250514",
    system_prompt="You are a helpful assistant.",
)
```

### 4. Connect with Triggers

```python
# src/{{ project_slug }}/agent/triggers.py
from {{ project_slug }}.agent.triggers import Trigger

Trigger(
    name="my-trigger",
    filter=my_event_filter,
    agent=my_agent,
)
```
{% if include_docs %}

## Documentation

```bash
make docs  # Serve docs locally at http://localhost:8001
```
{% endif %}

## Updating from Upstream

To pull updates from the Reflex template:

```bash
copier update
```

This will merge upstream improvements while preserving your customizations.

## License

MIT License
