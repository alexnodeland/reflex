meta {
  name: List Dead-Letter Queue
  type: http
  seq: 5
}

get {
  url: {{BASE_URL}}/events/dlq?limit=100
  body: none
  auth: none
}

assert {
  res.status: eq 200
  res.body.count: isNumber
  res.body.events: isDefined
}

script:post-response {
  const dlq = res.getBody();
  console.log('DLQ count:', dlq.count);
  if (dlq.events.length > 0) {
    console.log('First DLQ event:', dlq.events[0].id);
    bru.setVar('dlq_event_id', dlq.events[0].id);
  }
}
